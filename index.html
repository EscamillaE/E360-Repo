<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>InventorIA AI - Professional Home Inventory | Escloud</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cdefs%3E%3ClinearGradient id='grad' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%234f46e5;stop-opacity:1' /%3E%3Cstop offset='100%25' style='stop-color:%237c3aed;stop-opacity:1' /%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='100' height='100' rx='20' fill='url(%23grad)'/%3E%3Cpath d='M25 35h50v5H25zm0 15h50v5H25zm0 15h35v5H25z' fill='white'/%3E%3Ccircle cx='70' cy='65' r='8' fill='white'/%3E%3C/svg%3E">
    
    <!-- QR Code Library -->
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    <!-- Chart.js for infographics -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        :root {
            /* Original Perfect Professional Color Palette */
            --primary: #4f46e5;
            --primary-dark: #4338ca;
            --secondary: #7c3aed;
            --accent: #06b6d4;
            --neon-glow: #00d4ff;
            
            /* Light Theme */
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --bg-tertiary: #f1f5f9;
            --bg-card: #ffffff;
            --bg-hover: #f8fafc;
            
            /* Text Colors */
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --text-tertiary: #94a3b8;
            --text-inverse: #ffffff;
            
            /* Border Colors */
            --border-primary: #e2e8f0;
            --border-secondary: #cbd5e1;
            --border-focus: #4f46e5;
            
            /* Shadow */
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            
            /* Transitions */
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        [data-theme="dark"] {
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-tertiary: #334155;
            --bg-card: #1e293b;
            --bg-hover: #334155;
            
            --text-primary: #f8fafc;
            --text-secondary: #cbd5e1;
            --text-tertiary: #94a3b8;
            --text-inverse: #1e293b;
            
            --border-primary: #334155;
            --border-secondary: #475569;
            --border-focus: #6366f1;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', Roboto, sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            height: 100vh;
            overflow: hidden;
            transition: var(--transition);
        }

        /* Header */
        .header {
            background-color: var(--bg-card);
            border-bottom: 1px solid var(--border-primary);
            box-shadow: var(--shadow-sm);
            position: sticky;
            top: 0;
            z-index: 1000;
            height: 70px;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 100%;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
            text-decoration: none;
        }

        .logo-text {
            position: relative;
        }

        .logo-ai {
            color: var(--neon-glow);
            text-shadow: 0 0 10px var(--neon-glow), 0 0 20px var(--neon-glow), 0 0 30px var(--neon-glow);
            animation: neonGlow 2s ease-in-out infinite alternate;
        }

        @keyframes neonGlow {
            from {
                text-shadow: 0 0 5px var(--neon-glow), 0 0 10px var(--neon-glow), 0 0 15px var(--neon-glow);
            }
            to {
                text-shadow: 0 0 10px var(--neon-glow), 0 0 20px var(--neon-glow), 0 0 30px var(--neon-glow);
            }
        }

        .logo-subtitle {
            font-size: 0.65rem;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .theme-toggle, .ai-toggle {
            background: var(--bg-secondary);
            border: 1px solid var(--border-primary);
            border-radius: 50%;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            color: var(--text-secondary);
            font-size: 1rem;
        }

        .theme-toggle:hover, .ai-toggle:hover {
            background: var(--bg-hover);
            transform: scale(1.05);
        }

        .ai-toggle.active {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }

        /* Bottom Tab Navigation */
        .tab-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: var(--bg-card);
            border-top: 1px solid var(--border-primary);
            padding: 0.5rem 1rem;
            z-index: 1000;
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
        }

        .tab-nav-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-around;
            align-items: center;
        }

        .tab-button {
            background: none;
            border: none;
            padding: 0.5rem;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.25rem;
            position: relative;
            min-width: 60px;
            border-radius: 12px;
        }

        .tab-button.active {
            background: rgba(79, 70, 229, 0.1);
        }

        .tab-icon {
            font-size: 1.5rem;
            color: var(--text-tertiary);
            transition: var(--transition);
            filter: grayscale(1) brightness(1.2);
        }

        .tab-button.active .tab-icon {
            color: var(--primary);
            transform: scale(1.1);
            filter: grayscale(0) brightness(1);
        }

        .tab-button:hover .tab-icon {
            color: var(--text-secondary);
            transform: scale(1.05);
        }

        .tab-label {
            font-size: 0.65rem;
            font-weight: 600;
            color: var(--text-tertiary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            transition: var(--transition);
        }

        .tab-button.active .tab-label {
            color: var(--primary);
        }

        .tab-button:hover .tab-label {
            color: var(--text-secondary);
        }

        /* Main Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1.5rem;
            height: calc(100vh - 150px);
            overflow-y: auto;
        }

        /* Tab Content */
        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
            height: 100%;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Dashboard Grid - Infographic Style */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(12, 1fr);
            grid-template-rows: repeat(6, 1fr);
            gap: 1rem;
            height: calc(100vh - 200px);
        }

        /* Widget Sizes */
        .widget {
            background-color: var(--bg-card);
            border: 1px solid var(--border-primary);
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: var(--shadow-sm);
            transition: var(--transition-slow);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .widget:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        /* Widget Grid Positions */
        .widget-total-items {
            grid-column: 1 / 4;
            grid-row: 1 / 3;
        }

        .widget-total-value {
            grid-column: 4 / 7;
            grid-row: 1 / 3;
            background: linear-gradient(135deg, rgba(79, 70, 229, 0.05), rgba(124, 58, 237, 0.05));
        }

        .widget-rooms {
            grid-column: 7 / 10;
            grid-row: 1 / 2;
        }

        .widget-categories {
            grid-column: 10 / 13;
            grid-row: 1 / 2;
        }

        .widget-chart {
            grid-column: 1 / 8;
            grid-row: 3 / 7;
        }

        .widget-recent {
            grid-column: 8 / 13;
            grid-row: 2 / 7;
        }

        .widget-quick-stats {
            grid-column: 7 / 13;
            grid-row: 2 / 2;
            background: linear-gradient(135deg, rgba(6, 182, 212, 0.05), rgba(16, 185, 129, 0.05));
        }

        .widget-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .widget-title {
            font-size: 0.9rem;
            font-weight: 700;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .widget-icon {
            font-size: 1.2rem;
            color: var(--text-tertiary);
            filter: grayscale(1) brightness(1.3);
        }

        .widget-value {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
            text-align: center;
        }

        .widget-subtitle {
            color: var(--text-secondary);
            font-size: 0.8rem;
            font-weight: 500;
            text-align: center;
        }

        .widget-metric {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 0;
            border-bottom: 1px solid var(--border-primary);
        }

        .widget-metric:last-child {
            border-bottom: none;
        }

        .metric-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
            font-weight: 600;
        }

        .metric-value {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--primary);
        }

        /* Chart Container */
        .chart-container {
            position: relative;
            flex: 1;
            margin-top: 1rem;
        }

        /* Rotating Widget Animation */
        .widget-total-value {
            animation: pulseGlow 4s ease-in-out infinite;
        }

        @keyframes pulseGlow {
            0%, 100% { 
                box-shadow: var(--shadow-sm);
                transform: scale(1);
            }
            50% { 
                box-shadow: 0 0 20px rgba(79, 70, 229, 0.3);
                transform: scale(1.02);
            }
        }

        /* Category Sections */
        .category-section {
            margin-bottom: 1.5rem;
        }

        .category-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding: 0 0.5rem;
        }

        .category-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 0.6rem;
        }

        .category-icon {
            font-size: 1.2rem;
            color: var(--text-tertiary);
            filter: grayscale(1) brightness(1.3);
        }

        .category-count {
            background: var(--bg-secondary);
            color: var(--text-secondary);
            padding: 0.2rem 0.6rem;
            border-radius: 10px;
            font-size: 0.7rem;
            font-weight: 600;
        }

        /* Carousel */
        .carousel-container {
            position: relative;
            overflow: hidden;
            border-radius: 10px;
            flex: 1;
        }

        .carousel-track {
            display: flex;
            gap: 0.75rem;
            padding: 0.25rem 0;
            overflow-x: auto;
            overflow-y: hidden;
            scroll-behavior: smooth;
            scrollbar-width: none;
            -ms-overflow-style: none;
            height: 100%;
        }

        .carousel-track::-webkit-scrollbar {
            display: none;
        }

        /* Compact Item Cards */
        .item-card {
            min-width: 120px;
            width: 120px;
            height: 160px;
            background: var(--bg-card);
            border: 1px solid var(--border-primary);
            border-radius: 10px;
            overflow: hidden;
            cursor: pointer;
            transition: var(--transition-slow);
            position: relative;
            transform-style: preserve-3d;
            perspective: 1000px;
            box-shadow: var(--shadow-sm);
        }

        .item-card:hover {
            transform: translateY(-2px) scale(1.02);
            box-shadow: var(--shadow-md);
        }

        .item-card.flipped .card-front {
            transform: rotateY(-180deg);
        }

        .item-card.flipped .card-back {
            transform: rotateY(0deg);
        }

        .card-front,
        .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .card-back {
            transform: rotateY(180deg);
            background: var(--bg-card);
            padding: 0.75rem;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .item-image {
            width: 100%;
            height: 70px;
            background: linear-gradient(135deg, var(--bg-secondary), var(--bg-tertiary));
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .item-placeholder {
            font-size: 1.8rem;
            color: var(--text-tertiary);
            opacity: 0.7;
            filter: grayscale(1) brightness(1.3);
        }

        .item-value-badge {
            position: absolute;
            top: 0.3rem;
            right: 0.3rem;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 0.15rem 0.3rem;
            border-radius: 4px;
            font-size: 0.55rem;
            font-weight: 600;
        }

        .item-content {
            padding: 0.6rem;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .item-title {
            font-size: 0.75rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.15rem;
            line-height: 1.2;
        }

        .item-subtitle {
            color: var(--text-secondary);
            font-size: 0.65rem;
            margin-bottom: 0.4rem;
        }

        .item-room {
            background: var(--bg-secondary);
            color: var(--text-secondary);
            padding: 0.15rem 0.3rem;
            border-radius: 5px;
            font-size: 0.55rem;
            font-weight: 600;
            text-align: center;
        }

        /* Card Actions */
        .card-actions {
            position: absolute;
            top: 0.3rem;
            left: 0.3rem;
            display: flex;
            gap: 0.25rem;
            opacity: 0;
            transition: var(--transition);
        }

        .item-card:hover .card-actions {
            opacity: 1;
        }

        .action-btn {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: none;
            background: rgba(255, 255, 255, 0.9);
            color: var(--text-primary);
            font-size: 0.6rem;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .action-btn:hover {
            background: var(--primary);
            color: white;
            transform: scale(1.1);
        }

        /* Card Back Content */
        .card-back-header {
            text-align: center;
            margin-bottom: 0.6rem;
        }

        .card-back-title {
            font-size: 0.7rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.4rem;
        }

        .qr-code {
            width: 40px;
            height: 40px;
            margin: 0 auto 0.4rem;
            border-radius: 4px;
            overflow: hidden;
            background: white;
            padding: 2px;
        }

        .item-details {
            flex: 1;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.25rem 0;
            border-bottom: 1px solid var(--border-primary);
            font-size: 0.6rem;
        }

        .detail-row:last-child {
            border-bottom: none;
        }

        .detail-label {
            color: var(--text-secondary);
            font-weight: 600;
        }

        .detail-value {
            color: var(--text-primary);
            font-weight: 700;
            text-align: right;
            max-width: 45%;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .card-back-actions {
            display: flex;
            gap: 0.3rem;
            margin-top: 0.6rem;
        }

        .btn-small {
            flex: 1;
            padding: 0.3rem;
            border: none;
            border-radius: 5px;
            font-size: 0.55rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: var(--text-inverse);
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }

        .btn-secondary {
            background: var(--bg-secondary);
            color: var(--text-primary);
            border: 1px solid var(--border-primary);
        }

        .btn-secondary:hover {
            background: var(--bg-hover);
            transform: translateY(-1px);
        }

        /* AI Chat Interface */
        .ai-chat-container {
            background: var(--bg-card);
            border: 1px solid var(--border-primary);
            border-radius: 12px;
            box-shadow: var(--shadow-sm);
            overflow: hidden;
            height: calc(100vh - 200px);
            display: flex;
            flex-direction: column;
        }

        .ai-chat-header {
            padding: 1rem;
            border-bottom: 1px solid var(--border-primary);
            background: var(--bg-secondary);
        }

        .ai-chat-title {
            font-size: 1rem;
            font-weight: 700;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 0.4rem;
        }

        .ai-status {
            font-size: 0.7rem;
            color: var(--text-secondary);
            margin-top: 0.2rem;
        }

        .ai-status.connected {
            color: var(--accent);
        }

        .ai-status.error {
            color: #ef4444;
        }

        .ai-chat-messages {
            flex: 1;
            padding: 0.75rem;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .ai-message {
            max-width: 80%;
            padding: 0.6rem 0.8rem;
            border-radius: 10px;
            font-size: 0.8rem;
            line-height: 1.4;
        }

        .ai-message.user {
            align-self: flex-end;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
        }

        .ai-message.assistant {
            align-self: flex-start;
            background: var(--bg-secondary);
            border: 1px solid var(--border-primary);
            color: var(--text-primary);
        }

        .ai-message.system {
            align-self: center;
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            font-size: 0.7rem;
            max-width: 60%;
            text-align: center;
        }

        .ai-chat-input-container {
            padding: 0.75rem;
            border-top: 1px solid var(--border-primary);
            background: var(--bg-secondary);
        }

        .ai-input-wrapper {
            display: flex;
            gap: 0.6rem;
            align-items: flex-end;
        }

        .ai-chat-input {
            flex: 1;
            padding: 0.6rem 0.8rem;
            border: 1px solid var(--border-primary);
            border-radius: 10px;
            background: var(--bg-card);
            color: var(--text-primary);
            font-size: 0.8rem;
            resize: none;
            min-height: 36px;
            max-height: 80px;
            transition: var(--transition);
        }

        .ai-chat-input:focus {
            outline: none;
            border-color: var(--border-focus);
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }

        .ai-send-btn {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            border: none;
            border-radius: 50%;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            color: white;
            font-size: 0.9rem;
        }

        .ai-send-btn:hover {
            transform: scale(1.05);
            box-shadow: var(--shadow-md);
        }

        .ai-send-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* API Key Setup */
        .api-setup {
            background: var(--bg-card);
            border: 1px solid var(--border-primary);
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1rem;
            box-shadow: var(--shadow-sm);
        }

        .api-setup-title {
            font-size: 0.9rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.6rem;
            display: flex;
            align-items: center;
            gap: 0.4rem;
        }

        .api-key-input {
            width: 100%;
            padding: 0.6rem 0.8rem;
            border: 1px solid var(--border-primary);
            border-radius: 6px;
            background: var(--bg-secondary);
            color: var(--text-primary);
            font-size: 0.8rem;
            margin-bottom: 0.6rem;
            transition: var(--transition);
        }

        .api-key-input:focus {
            outline: none;
            border-color: var(--border-focus);
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 0.4rem;
            padding: 0.6rem 1rem;
            border: none;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            text-decoration: none;
            white-space: nowrap;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: var(--text-inverse);
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }

        .btn-secondary {
            background: var(--bg-secondary);
            color: var(--text-primary);
            border: 1px solid var(--border-primary);
        }

        .btn-secondary:hover {
            background: var(--bg-hover);
            transform: translateY(-1px);
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--bg-card);
            border-radius: 12px;
            max-width: 400px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-lg);
        }

        .modal-header {
            padding: 1rem 1rem 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 1rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .modal-close {
            background: var(--bg-secondary);
            border: 1px solid var(--border-primary);
            border-radius: 50%;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .modal-close:hover {
            background: var(--bg-hover);
            transform: scale(1.1);
        }

        .modal-body {
            padding: 1rem;
        }

        /* Form Styles */
        .form-grid {
            display: grid;
            gap: 0.75rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 0.4rem;
        }

        .form-label {
            font-weight: 600;
            color: var(--text-primary);
            font-size: 0.8rem;
        }

        .form-input,
        .form-select,
        .form-textarea {
            padding: 0.6rem;
            border: 1px solid var(--border-primary);
            border-radius: 6px;
            background: var(--bg-secondary);
            color: var(--text-primary);
            font-size: 0.8rem;
            transition: var(--transition);
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            outline: none;
            border-color: var(--border-focus);
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }

        .form-textarea {
            min-height: 60px;
            resize: vertical;
        }

        .form-grid-2 {
            grid-template-columns: 1fr 1fr;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 2rem 1rem;
            color: var(--text-secondary);
        }

        .empty-icon {
            font-size: 3rem;
            color: var(--text-tertiary);
            margin-bottom: 0.75rem;
            opacity: 0.7;
            filter: grayscale(1) brightness(1.3);
        }

        .empty-title {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        .empty-description {
            margin-bottom: 1rem;
            max-width: 300px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Search */
        .search-container {
            margin-bottom: 1.5rem;
        }

        .search-input {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid var(--border-primary);
            border-radius: 8px;
            background: var(--bg-secondary);
            color: var(--text-primary);
            font-size: 0.9rem;
            transition: var(--transition);
        }

        .search-input:focus {
            outline: none;
            border-color: var(--border-focus);
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }

        /* Settings */
        .settings-grid {
            display: grid;
            gap: 0.75rem;
            max-width: 300px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: repeat(6, 1fr);
                grid-template-rows: repeat(8, 1fr);
            }

            .widget-total-items {
                grid-column: 1 / 4;
                grid-row: 1 / 2;
            }

            .widget-total-value {
                grid-column: 4 / 7;
                grid-row: 1 / 2;
            }

            .widget-rooms {
                grid-column: 1 / 3;
                grid-row: 2 / 3;
            }

            .widget-categories {
                grid-column: 3 / 5;
                grid-row: 2 / 3;
            }

            .widget-quick-stats {
                grid-column: 5 / 7;
                grid-row: 2 / 3;
            }

            .widget-chart {
                grid-column: 1 / 7;
                grid-row: 3 / 6;
            }

            .widget-recent {
                grid-column: 1 / 7;
                grid-row: 6 / 9;
            }

            .container {
                padding: 1rem;
            }

            .header-content {
                padding: 0.75rem 1rem;
            }

            .item-card {
                min-width: 100px;
                width: 100px;
                height: 140px;
            }

            .form-grid-2 {
                grid-template-columns: 1fr;
            }

            .ai-chat-container {
                height: calc(100vh - 180px);
            }
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 1rem;
            right: 1rem;
            background: var(--bg-card);
            border: 1px solid var(--border-primary);
            border-radius: 6px;
            padding: 0.75rem 1rem;
            box-shadow: var(--shadow-lg);
            z-index: 3000;
            transform: translateX(400px);
            transition: var(--transition);
            max-width: 300px;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            border-left: 4px solid #10b981;
        }

        .notification.error {
            border-left: 4px solid #ef4444;
        }

        .notification.warning {
            border-left: 4px solid #f59e0b;
        }

        /* Loading Animation */
        .loading-dots {
            display: inline-flex;
            gap: 2px;
        }

        .loading-dots span {
            width: 4px;
            height: 4px;
            border-radius: 50%;
            background: var(--text-secondary);
            animation: loadingDots 1.4s ease-in-out infinite both;
        }

        .loading-dots span:nth-child(1) { animation-delay: -0.32s; }
        .loading-dots span:nth-child(2) { animation-delay: -0.16s; }

        @keyframes loadingDots {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1); }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <a href="#" class="logo">
                <div>
                    <span class="logo-text">Inventor<span class="logo-ai">IA</span></span>
                    <div class="logo-subtitle">by Escloud</div>
                </div>
            </a>
            <div class="header-actions">
                <button class="ai-toggle" onclick="toggleAI()" title="Toggle AI Assistant" id="aiToggle">
                    <span>üß†</span>
                </button>
                <button class="theme-toggle" onclick="toggleTheme()" title="Toggle theme">
                    <span id="theme-icon">üåô</span>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <div class="container">
        <!-- Dashboard Tab -->
        <div class="tab-content active" id="dashboard-tab">
            <div class="dashboard-grid">
                <!-- Total Items Widget -->
                <div class="widget widget-total-items">
                    <div class="widget-header">
                        <div class="widget-title">
                            <span class="widget-icon">üì¶</span>
                            Total Items
                        </div>
                    </div>
                    <div class="widget-value" id="totalItems">0</div>
                    <div class="widget-subtitle">Items in inventory</div>
                </div>

                <!-- Total Value Widget -->
                <div class="widget widget-total-value">
                    <div class="widget-header">
                        <div class="widget-title">
                            <span class="widget-icon">üí∞</span>
                            Total Value
                        </div>
                    </div>
                    <div class="widget-value" id="totalValue">$0</div>
                    <div class="widget-subtitle">Estimated worth</div>
                </div>

                <!-- Rooms Widget -->
                <div class="widget widget-rooms">
                    <div class="widget-header">
                        <div class="widget-title">
                            <span class="widget-icon">üè†</span>
                            Rooms
                        </div>
                    </div>
                    <div class="widget-value" id="totalRooms">0</div>
                    <div class="widget-subtitle">Areas</div>
                </div>

                <!-- Categories Widget -->
                <div class="widget widget-categories">
                    <div class="widget-header">
                        <div class="widget-title">
                            <span class="widget-icon">üìÇ</span>
                            Categories
                        </div>
                    </div>
                    <div class="widget-value" id="totalCategories">0</div>
                    <div class="widget-subtitle">Types</div>
                </div>

                <!-- Quick Stats Widget -->
                <div class="widget widget-quick-stats">
                    <div class="widget-header">
                        <div class="widget-title">
                            <span class="widget-icon">üìä</span>
                            Quick Stats
                        </div>
                    </div>
                    <div class="widget-metric">
                        <span class="metric-label">Avg Value</span>
                        <span class="metric-value" id="avgValue">$0</span>
                    </div>
                    <div class="widget-metric">
                        <span class="metric-label">Most Valuable</span>
                        <span class="metric-value" id="mostValuable">-</span>
                    </div>
                    <div class="widget-metric">
                        <span class="metric-label">Latest Added</span>
                        <span class="metric-value" id="latestAdded">-</span>
                    </div>
                </div>

                <!-- Value Distribution Chart -->
                <div class="widget widget-chart">
                    <div class="widget-header">
                        <div class="widget-title">
                            <span class="widget-icon">üìä</span>
                            Value Distribution
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="valueChart"></canvas>
                    </div>
                </div>

                <!-- Recent Items -->
                <div class="widget widget-recent">
                    <div class="widget-header">
                        <div class="widget-title">
                            <span class="widget-icon">‚≠ê</span>
                            Recent Items
                        </div>
                        <button class="btn btn-primary" onclick="openAddModal()">
                            <span>‚ûï</span>
                            Add
                        </button>
                    </div>
                    <div class="carousel-container">
                        <div class="carousel-track" id="recent-carousel">
                            <!-- Recent items will be populated here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Categories Tab -->
        <div class="tab-content" id="categories-tab">
            <div id="categories-content">
                <!-- Categories will be populated here -->
            </div>
        </div>

        <!-- Rooms Tab -->
        <div class="tab-content" id="rooms-tab">
            <div id="rooms-content">
                <!-- Rooms will be populated here -->
            </div>
        </div>

        <!-- AI Assistant Tab -->
        <div class="tab-content" id="ai-tab">
            <!-- API Key Setup -->
            <div class="api-setup" id="apiSetup">
                <div class="api-setup-title">
                    <span>üîë</span>
                    OpenAI API Configuration
                </div>
                <p style="color: var(--text-secondary); margin-bottom: 0.75rem; font-size: 0.8rem;">
                    Enter your OpenAI API key to enable AI-powered inventory assistance. Your key is stored locally and never shared.
                </p>
                <input type="password" class="api-key-input" id="apiKeyInput" placeholder="sk-...">
                <button class="btn btn-primary" onclick="saveApiKey()">
                    <span>üíæ</span>
                    Save API Key
                </button>
            </div>

            <!-- AI Chat Interface -->
            <div class="ai-chat-container" id="aiChatContainer" style="display: none;">
                <div class="ai-chat-header">
                    <div>
                        <div class="ai-chat-title">
                            <span>ü§ñ</span>
                            InventorIA AI Assistant
                        </div>
                        <div class="ai-status" id="aiStatus">Ready to help with your inventory</div>
                    </div>
                </div>
                <div class="ai-chat-messages" id="aiMessages">
                    <div class="ai-message system">
                        Welcome! I'm your InventorIA AI Assistant. I can help you manage your inventory, answer questions about your items, suggest organization strategies, and provide insights about your collection.
                    </div>
                </div>
                <div class="ai-chat-input-container">
                    <div class="ai-input-wrapper">
                        <textarea class="ai-chat-input" id="aiInput" placeholder="Ask me about your inventory..." rows="1"></textarea>
                        <button class="ai-send-btn" id="aiSendBtn" onclick="sendAIMessage()">
                            <span>‚û§</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Search Tab -->
        <div class="tab-content" id="search-tab">
            <div class="search-container">
                <input type="text" class="search-input" placeholder="Search items..." id="searchInput">
            </div>
            <div id="search-results">
                <div class="empty-state">
                    <div class="empty-icon">üîç</div>
                    <h3 class="empty-title">Search Your Inventory</h3>
                    <p class="empty-description">
                        Type above to search through all your items by name, description, or notes.
                    </p>
                </div>
            </div>
        </div>

        <!-- Settings Tab -->
        <div class="tab-content" id="settings-tab">
            <div class="category-section">
                <div class="category-header">
                    <h2 class="category-title">
                        <span class="category-icon">‚öôÔ∏è</span>
                        Settings & Tools
                    </h2>
                </div>
                <div class="settings-grid">
                    <button class="btn btn-primary" onclick="exportData()">
                        <span>üì§</span>
                        Export Data
                    </button>
                    <button class="btn btn-secondary" onclick="importData()">
                        <span>üì•</span>
                        Import Data
                    </button>
                    <button class="btn btn-secondary" onclick="generateReport()">
                        <span>üìä</span>
                        Generate Report
                    </button>
                    <button class="btn btn-secondary" onclick="clearAllData()">
                        <span>üóëÔ∏è</span>
                        Clear All Data
                    </button>
                    <button class="btn btn-secondary" onclick="clearApiKey()">
                        <span>üîë</span>
                        Clear API Key
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bottom Tab Navigation -->
    <nav class="tab-nav">
        <div class="tab-nav-content">
            <button class="tab-button active" data-tab="dashboard" onclick="switchTab('dashboard')">
                <div class="tab-icon">üìä</div>
                <div class="tab-label">Dashboard</div>
            </button>
            <button class="tab-button" data-tab="categories" onclick="switchTab('categories')">
                <div class="tab-icon">üìÇ</div>
                <div class="tab-label">Categories</div>
            </button>
            <button class="tab-button" data-tab="rooms" onclick="switchTab('rooms')">
                <div class="tab-icon">üè†</div>
                <div class="tab-label">Rooms</div>
            </button>
            <button class="tab-button" data-tab="ai" onclick="switchTab('ai')">
                <div class="tab-icon">ü§ñ</div>
                <div class="tab-label">AI Assistant</div>
            </button>
            <button class="tab-button" data-tab="search" onclick="switchTab('search')">
                <div class="tab-icon">üîç</div>
                <div class="tab-label">Search</div>
            </button>
            <button class="tab-button" data-tab="settings" onclick="switchTab('settings')">
                <div class="tab-icon">‚öôÔ∏è</div>
                <div class="tab-label">Settings</div>
            </button>
        </div>
    </nav>

    <!-- Add Item Modal -->
    <div class="modal" id="itemModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="modalTitle">Add New Item</h3>
                <button class="modal-close" onclick="closeModal()">√ó</button>
            </div>
            <div class="modal-body">
                <form id="itemForm" class="form-grid">
                    <div class="form-group">
                        <label class="form-label" for="itemName">Item Name *</label>
                        <input type="text" class="form-input" id="itemName" required>
                    </div>

                    <div class="form-grid form-grid-2">
                        <div class="form-group">
                            <label class="form-label" for="itemRoom">Room/Area *</label>
                            <select class="form-select" id="itemRoom" required>
                                <option value="">Select Room</option>
                                <option value="living-room">Living Room</option>
                                <option value="dining-room">Dining Room</option>
                                <option value="bedroom">Bedroom</option>
                                <option value="kitchen">Kitchen</option>
                                <option value="bathroom">Bathroom</option>
                                <option value="office">Office</option>
                                <option value="garage">Garage</option>
                                <option value="basement">Basement</option>
                                <option value="attic">Attic</option>
                                <option value="closet">Closet</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="itemCategory">Category *</label>
                            <select class="form-select" id="itemCategory" required>
                                <option value="">Select Category</option>
                                <option value="electronics">Electronics</option>
                                <option value="furniture">Furniture</option>
                                <option value="appliances">Appliances</option>
                                <option value="jewelry">Jewelry</option>
                                <option value="art">Art & Collectibles</option>
                                <option value="clothing">Clothing</option>
                                <option value="books">Books</option>
                                <option value="tools">Tools</option>
                                <option value="sports">Sports Equipment</option>
                                <option value="musical">Musical Instruments</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="itemDescription">Description/Model</label>
                        <input type="text" class="form-input" id="itemDescription">
                    </div>

                    <div class="form-grid form-grid-2">
                        <div class="form-group">
                            <label class="form-label" for="itemSerial">Serial Number</label>
                            <input type="text" class="form-input" id="itemSerial">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="itemCurrentValue">Current Value *</label>
                            <input type="number" class="form-input" id="itemCurrentValue" step="0.01" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="itemNotes">Notes</label>
                        <textarea class="form-textarea" id="itemNotes" placeholder="Additional notes..."></textarea>
                    </div>

                    <div style="display: flex; gap: 0.75rem; justify-content: flex-end; margin-top: 0.75rem;">
                        <button type="button" class="btn btn-secondary" onclick="closeModal()">Cancel</button>
                        <button type="submit" class="btn btn-primary">
                            <span id="saveText">Save Item</span>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let homeItems = [];
        let currentEditingItem = null;
        let currentTheme = localStorage.getItem('theme') || 'light';
        let activeTab = 'dashboard';
        let valueChart = null;
        let openaiApiKey = localStorage.getItem('openai_api_key') || '';
        let aiEnabled = false;

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            setupEventListeners();
            loadHomeItems();
            updateStats();
            applyTheme();
            loadSampleData();
            initializeAI();
        });

        function initializeApp() {
            // Set up form submission
            document.getElementById('itemForm').addEventListener('submit', handleFormSubmit);

            // Set up search
            document.getElementById('searchInput').addEventListener('input', handleSearch);

            // Modal close on outside click
            document.getElementById('itemModal').addEventListener('click', (e) => {
                if (e.target.id === 'itemModal') {
                    closeModal();
                }
            });

            // AI input auto-resize
            const aiInput = document.getElementById('aiInput');
            aiInput.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = Math.min(this.scrollHeight, 80) + 'px';
            });

            // AI input enter key
            aiInput.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendAIMessage();
                }
            });
        }

        function setupEventListeners() {
            // Any additional event listeners can be added here
        }

        function loadSampleData() {
            // InventorIA - Your complete inventory data from Excel file
            // Owner: Ayesha Khalique, Address: 4567 8th Ave, Carson City
            // Phone: (916) 555-0123, Insurance Policy: XYZ789
            // Agent: Petja Hrovat, Phone: (123) 456-7890
            const inventoriaData = [
                {
                    id: '1',
                    name: 'Piano',
                    description: 'Baby grand',
                    room: 'living-room',
                    category: 'musical',
                    serialNumber: '100123',
                    purchaseDate: '',
                    purchasePrice: '',
                    currentValue: 3000,
                    store: '',
                    notes: 'Family heirloom',
                    hasPhoto: true,
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                },
                {
                    id: '2',
                    name: 'Chandelier',
                    description: 'Crystal',
                    room: 'dining-room',
                    category: 'furniture',
                    serialNumber: '',
                    purchaseDate: '2019-11-15',
                    purchasePrice: 500,
                    currentValue: 585.25,
                    store: 'Em + En Design',
                    notes: '',
                    hasPhoto: true,
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                },
                {
                    id: '3',
                    name: 'Engagement Ring',
                    description: 'Princess cut',
                    room: 'bedroom',
                    category: 'jewelry',
                    serialNumber: 'ABC123',
                    purchaseDate: '2010-09-14',
                    purchasePrice: 1295,
                    currentValue: 1770,
                    store: 'Francis Ribeiro Jewelry',
                    notes: 'In safe',
                    hasPhoto: true,
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                }
            ];

            if (homeItems.length === 0) {
                homeItems = inventoriaData;
                saveHomeItems();
                renderAllContent();
                showNotification('‚úÖ InventorIA AI loaded! Complete inventory: $5,355.25', 'success');
            }
        }

        function loadHomeItems() {
            const savedItems = localStorage.getItem('homeInventoryItems');
            if (savedItems) {
                homeItems = JSON.parse(savedItems);
                renderAllContent();
            }
        }

        function saveHomeItems() {
            localStorage.setItem('homeInventoryItems', JSON.stringify(homeItems));
            updateStats();
        }

        function updateStats() {
            const totalItems = homeItems.length;
            const totalValue = homeItems.reduce((sum, item) => sum + (parseFloat(item.currentValue) || 0), 0);
            const rooms = [...new Set(homeItems.map(item => item.room))].length;
            const categories = [...new Set(homeItems.map(item => item.category))].length;

            // Basic stats
            document.getElementById('totalItems').textContent = totalItems.toLocaleString();
            document.getElementById('totalValue').textContent = `$${totalValue.toLocaleString()}`;
            document.getElementById('totalRooms').textContent = rooms;
            document.getElementById('totalCategories').textContent = categories;

            // Quick stats
            const avgValue = totalItems > 0 ? totalValue / totalItems : 0;
            document.getElementById('avgValue').textContent = `$${Math.round(avgValue).toLocaleString()}`;

            // Most valuable item
            const mostValuableItem = homeItems.reduce((max, item) => 
                (parseFloat(item.currentValue) || 0) > (parseFloat(max.currentValue) || 0) ? item : max, 
                homeItems[0] || {}
            );
            document.getElementById('mostValuable').textContent = mostValuableItem.name || '-';

            // Latest added item
            const latestItem = [...homeItems].sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt))[0];
            document.getElementById('latestAdded').textContent = latestItem ? latestItem.name : '-';

            // Update chart
            updateValueChart();
        }

        function updateValueChart() {
            const ctx = document.getElementById('valueChart');
            if (!ctx) return;

            // Prepare data for chart
            const categoryData = {};
            homeItems.forEach(item => {
                const category = getCategoryText(item.category);
                const value = parseFloat(item.currentValue) || 0;
                categoryData[category] = (categoryData[category] || 0) + value;
            });

            const labels = Object.keys(categoryData);
            const data = Object.values(categoryData);
            const colors = [
                'rgba(79, 70, 229, 0.8)',
                'rgba(124, 58, 237, 0.8)',
                'rgba(6, 182, 212, 0.8)',
                'rgba(16, 185, 129, 0.8)',
                'rgba(245, 158, 11, 0.8)',
                'rgba(239, 68, 68, 0.8)',
                'rgba(139, 92, 246, 0.8)',
                'rgba(6, 182, 212, 0.8)'
            ];

            if (valueChart) {
                valueChart.destroy();
            }

            valueChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: labels,
                    datasets: [{
                        data: data,
                        backgroundColor: colors.slice(0, labels.length),
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: getComputedStyle(document.documentElement).getPropertyValue('--text-secondary'),
                                padding: 8,
                                usePointStyle: true,
                                font: {
                                    size: 10
                                }
                            }
                        }
                    }
                }
            });
        }

        function renderAllContent() {
            renderRecentItems();
            renderCategoriesTab();
            renderRoomsTab();
            updateStats();
        }

        function renderRecentItems() {
            const carousel = document.getElementById('recent-carousel');
            const recentItems = homeItems.slice(-6).reverse(); // Last 6 items, newest first

            if (recentItems.length === 0) {
                carousel.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">üì¶</div>
                        <h3 class="empty-title">No Items Yet</h3>
                        <p class="empty-description">Add your first item to get started!</p>
                    </div>
                `;
                return;
            }

            carousel.innerHTML = recentItems.map(item => createItemCard(item)).join('');
        }

        function renderCategoriesTab() {
            const container = document.getElementById('categories-content');
            const categoriesMap = {};

            // Group items by category
            homeItems.forEach(item => {
                if (!categoriesMap[item.category]) {
                    categoriesMap[item.category] = [];
                }
                categoriesMap[item.category].push(item);
            });

            if (Object.keys(categoriesMap).length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">üìÇ</div>
                        <h3 class="empty-title">No Categories Yet</h3>
                        <p class="empty-description">Add items to see them organized by category.</p>
                        <button class="btn btn-primary" onclick="openAddModal()">
                            <span>‚ûï</span>
                            Add First Item
                        </button>
                    </div>
                `;
                return;
            }

            container.innerHTML = Object.entries(categoriesMap).map(([category, items]) => `
                <div class="category-section">
                    <div class="category-header">
                        <h2 class="category-title">
                            <span class="category-icon">${getCategoryIcon(category)}</span>
                            ${getCategoryText(category)}
                        </h2>
                        <span class="category-count">${items.length} items</span>
                    </div>
                    <div class="carousel-container">
                        <div class="carousel-track">
                            ${items.map(item => createItemCard(item)).join('')}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function renderRoomsTab() {
            const container = document.getElementById('rooms-content');
            const roomsMap = {};

            // Group items by room
            homeItems.forEach(item => {
                if (!roomsMap[item.room]) {
                    roomsMap[item.room] = [];
                }
                roomsMap[item.room].push(item);
            });

            if (Object.keys(roomsMap).length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">üè†</div>
                        <h3 class="empty-title">No Rooms Yet</h3>
                        <p class="empty-description">Add items to see them organized by room.</p>
                        <button class="btn btn-primary" onclick="openAddModal()">
                            <span>‚ûï</span>
                            Add First Item
                        </button>
                    </div>
                `;
                return;
            }

            container.innerHTML = Object.entries(roomsMap).map(([room, items]) => `
                <div class="category-section">
                    <div class="category-header">
                        <h2 class="category-title">
                            <span class="category-icon">üè†</span>
                            ${getRoomText(room)}
                        </h2>
                        <span class="category-count">${items.length} items</span>
                    </div>
                    <div class="carousel-container">
                        <div class="carousel-track">
                            ${items.map(item => createItemCard(item)).join('')}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function createItemCard(item) {
            const categoryIcon = getCategoryIcon(item.category);
            const roomText = getRoomText(item.room);
            const itemIndex = homeItems.findIndex(i => i.id === item.id);

            return `
                <div class="item-card" onclick="flipCard(this, ${itemIndex})">
                    <div class="card-actions">
                        <button class="action-btn" onclick="event.stopPropagation(); editItem(${itemIndex})" title="Edit">
                            ‚úèÔ∏è
                        </button>
                        <button class="action-btn" onclick="event.stopPropagation(); deleteItem(${itemIndex})" title="Delete">
                            üóëÔ∏è
                        </button>
                    </div>
                    <div class="card-front">
                        <div class="item-image">
                            <div class="item-placeholder">${categoryIcon}</div>
                            ${item.currentValue ? `<div class="item-value-badge">$${parseFloat(item.currentValue).toLocaleString()}</div>` : ''}
                        </div>
                        <div class="item-content">
                            <div>
                                <h3 class="item-title">${item.name}</h3>
                                <p class="item-subtitle">${item.description || 'No description'}</p>
                            </div>
                            <div class="item-room">${roomText}</div>
                        </div>
                    </div>
                    <div class="card-back">
                        <div class="card-back-header">
                            <h3 class="card-back-title">${item.name}</h3>
                            <div class="qr-code" id="qr-${item.id}"></div>
                        </div>
                        <div class="item-details">
                            <div class="detail-row">
                                <span class="detail-label">Category</span>
                                <span class="detail-value">${getCategoryText(item.category)}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Room</span>
                                <span class="detail-value">${roomText}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Value</span>
                                <span class="detail-value">$${parseFloat(item.currentValue || 0).toLocaleString()}</span>
                            </div>
                            ${item.serialNumber ? `
                                <div class="detail-row">
                                    <span class="detail-label">Serial</span>
                                    <span class="detail-value">${item.serialNumber}</span>
                                </div>
                            ` : ''}
                            ${item.notes ? `
                                <div class="detail-row">
                                    <span class="detail-label">Notes</span>
                                    <span class="detail-value">${item.notes}</span>
                                </div>
                            ` : ''}
                        </div>
                        <div class="card-back-actions">
                            <button class="btn-small btn-primary" onclick="event.stopPropagation(); editItem(${itemIndex})">Edit</button>
                            <button class="btn-small btn-secondary" onclick="event.stopPropagation(); deleteItem(${itemIndex})">Delete</button>
                        </div>
                    </div>
                </div>
            `;
        }

        function flipCard(cardElement, itemIndex) {
            const item = homeItems[itemIndex];
            cardElement.classList.toggle('flipped');
            
            // Generate QR code when card is flipped
            if (cardElement.classList.contains('flipped')) {
                setTimeout(() => {
                    const qrContainer = document.getElementById(`qr-${item.id}`);
                    if (qrContainer && !qrContainer.hasChildNodes()) {
                        const itemData = {
                            id: item.id,
                            name: item.name,
                            description: item.description,
                            category: item.category,
                            room: item.room,
                            value: item.currentValue,
                            serial: item.serialNumber,
                            notes: item.notes,
                            owner: 'Ayesha Khalique',
                            address: '4567 8th Ave, Carson City',
                            phone: '(916) 555-0123',
                            insurance: 'XYZ789',
                            agent: 'Petja Hrovat',
                            agentPhone: '(123) 456-7890',
                            inventorIA: 'Escloud Project'
                        };
                        
                        QRCode.toCanvas(qrContainer, JSON.stringify(itemData), {
                            width: 40,
                            height: 40,
                            margin: 1,
                            color: {
                                dark: '#2d3748',
                                light: '#ffffff'
                            }
                        });
                    }
                }, 300);
            }
        }

        function switchTab(tabName) {
            // Update active tab button
            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
            const activeButton = document.querySelector(`.tab-button[data-tab="${tabName}"]`);
            if (activeButton) {
                activeButton.classList.add('active');
            }

            // Update active tab content
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.getElementById(`${tabName}-tab`).classList.add('active');

            activeTab = tabName;
        }

        function handleSearch() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const resultsContainer = document.getElementById('search-results');

            if (!searchTerm.trim()) {
                resultsContainer.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">üîç</div>
                        <h3 class="empty-title">Search Your Inventory</h3>
                        <p class="empty-description">
                            Type above to search through all your items by name, description, or notes.
                        </p>
                    </div>
                `;
                return;
            }

            const filteredItems = homeItems.filter(item => 
                item.name.toLowerCase().includes(searchTerm) ||
                (item.description || '').toLowerCase().includes(searchTerm) ||
                (item.notes || '').toLowerCase().includes(searchTerm) ||
                getCategoryText(item.category).toLowerCase().includes(searchTerm) ||
                getRoomText(item.room).toLowerCase().includes(searchTerm)
            );

            if (filteredItems.length === 0) {
                resultsContainer.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">‚ùå</div>
                        <h3 class="empty-title">No Results Found</h3>
                        <p class="empty-description">
                            No items match your search for "${searchTerm}".
                        </p>
                    </div>
                `;
                return;
            }

            resultsContainer.innerHTML = `
                <div class="category-section">
                    <div class="category-header">
                        <h2 class="category-title">
                            <span class="category-icon">üîç</span>
                            Search Results
                        </h2>
                        <span class="category-count">${filteredItems.length} items</span>
                    </div>
                    <div class="carousel-container">
                        <div class="carousel-track">
                            ${filteredItems.map(item => createItemCard(item)).join('')}
                        </div>
                    </div>
                </div>
            `;
        }

        // AI Functions
        function initializeAI() {
            if (openaiApiKey) {
                document.getElementById('apiKeyInput').value = openaiApiKey;
                enableAI();
            }
        }

        function saveApiKey() {
            const apiKey = document.getElementById('apiKeyInput').value.trim();
            if (!apiKey) {
                showNotification('Please enter a valid API key', 'error');
                return;
            }

            if (!apiKey.startsWith('sk-')) {
                showNotification('Invalid API key format', 'error');
                return;
            }

            openaiApiKey = apiKey;
            localStorage.setItem('openai_api_key', apiKey);
            enableAI();
            showNotification('API key saved successfully', 'success');
        }

        function enableAI() {
            aiEnabled = true;
            document.getElementById('apiSetup').style.display = 'none';
            document.getElementById('aiChatContainer').style.display = 'flex';
            document.getElementById('aiToggle').classList.add('active');
            updateAIStatus('Ready to help with your inventory', 'connected');
        }

        function toggleAI() {
            if (!aiEnabled) {
                switchTab('ai');
                return;
            }

            aiEnabled = !aiEnabled;
            const toggle = document.getElementById('aiToggle');
            
            if (aiEnabled) {
                toggle.classList.add('active');
                updateAIStatus('AI Assistant enabled', 'connected');
            } else {
                toggle.classList.remove('active');
                updateAIStatus('AI Assistant disabled', 'error');
            }
        }

        function updateAIStatus(message, type) {
            const status = document.getElementById('aiStatus');
            status.textContent = message;
            status.className = `ai-status ${type}`;
        }

        async function sendAIMessage() {
            if (!aiEnabled || !openaiApiKey) {
                showNotification('Please configure your OpenAI API key first', 'error');
                return;
            }

            const input = document.getElementById('aiInput');
            const message = input.value.trim();
            
            if (!message) return;

            // Add user message
            addAIMessage(message, 'user');
            input.value = '';
            input.style.height = 'auto';

            // Disable send button
            const sendBtn = document.getElementById('aiSendBtn');
            sendBtn.disabled = true;
            sendBtn.innerHTML = '<div class="loading-dots"><span></span><span></span><span></span></div>';

            updateAIStatus('Thinking...', 'connected');

            try {
                // Prepare context about the inventory
                const inventoryContext = {
                    totalItems: homeItems.length,
                    totalValue: homeItems.reduce((sum, item) => sum + (parseFloat(item.currentValue) || 0), 0),
                    items: homeItems.map(item => ({
                        name: item.name,
                        description: item.description,
                        category: getCategoryText(item.category),
                        room: getRoomText(item.room),
                        value: item.currentValue,
                        serial: item.serialNumber,
                        notes: item.notes
                    })),
                    owner: {
                        name: 'Ayesha Khalique',
                        address: '4567 8th Ave, Carson City',
                        phone: '(916) 555-0123',
                        insurance: 'XYZ789',
                        agent: 'Petja Hrovat'
                    }
                };

                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${openaiApiKey}`
                    },
                    body: JSON.stringify({
                        model: 'gpt-3.5-turbo',
                        messages: [
                            {
                                role: 'system',
                                content: `You are InventorIA AI, a professional home inventory assistant created by Escloud. You help users manage their home inventory with expertise in organization, insurance, moving, and asset management. 

Current inventory context: ${JSON.stringify(inventoryContext)}

Provide helpful, professional advice about inventory management, organization strategies, insurance considerations, moving tips, and item valuations. Be concise but informative.`
                            },
                            {
                                role: 'user',
                                content: message
                            }
                        ],
                        max_tokens: 500,
                        temperature: 0.7
                    })
                });

                if (!response.ok) {
                    throw new Error(`API Error: ${response.status}`);
                }

                const data = await response.json();
                const aiResponse = data.choices[0].message.content;

                addAIMessage(aiResponse, 'assistant');
                updateAIStatus('Ready to help', 'connected');

            } catch (error) {
                console.error('AI Error:', error);
                addAIMessage('Sorry, I encountered an error. Please check your API key and try again.', 'assistant');
                updateAIStatus('Error occurred', 'error');
            } finally {
                // Re-enable send button
                sendBtn.disabled = false;
                sendBtn.innerHTML = '<span>‚û§</span>';
            }
        }

        function addAIMessage(message, type) {
            const messagesContainer = document.getElementById('aiMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `ai-message ${type}`;
            messageDiv.textContent = message;
            
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function clearApiKey() {
            if (confirm('Are you sure you want to clear your API key?')) {
                openaiApiKey = '';
                localStorage.removeItem('openai_api_key');
                aiEnabled = false;
                document.getElementById('apiKeyInput').value = '';
                document.getElementById('apiSetup').style.display = 'block';
                document.getElementById('aiChatContainer').style.display = 'none';
                document.getElementById('aiToggle').classList.remove('active');
                showNotification('API key cleared', 'success');
            }
        }

        function openAddModal() {
            currentEditingItem = null;
            document.getElementById('modalTitle').textContent = 'Add New Item';
            document.getElementById('itemForm').reset();
            document.getElementById('itemModal').classList.add('active');
        }

        function editItem(index) {
            currentEditingItem = index;
            const item = homeItems[index];
            
            document.getElementById('modalTitle').textContent = 'Edit Item';
            document.getElementById('itemName').value = item.name;
            document.getElementById('itemDescription').value = item.description || '';
            document.getElementById('itemRoom').value = item.room;
            document.getElementById('itemCategory').value = item.category;
            document.getElementById('itemSerial').value = item.serialNumber || '';
            document.getElementById('itemCurrentValue').value = item.currentValue || '';
            document.getElementById('itemNotes').value = item.notes || '';
            
            document.getElementById('itemModal').classList.add('active');
        }

        function deleteItem(index) {
            if (confirm('Are you sure you want to delete this item?')) {
                homeItems.splice(index, 1);
                saveHomeItems();
                renderAllContent();
                showNotification('Item deleted successfully', 'success');
            }
        }

        function closeModal() {
            document.getElementById('itemModal').classList.remove('active');
            currentEditingItem = null;
        }

        function handleFormSubmit(e) {
            e.preventDefault();
            
            const item = {
                id: currentEditingItem !== null ? homeItems[currentEditingItem].id : Date.now().toString(),
                name: document.getElementById('itemName').value,
                description: document.getElementById('itemDescription').value,
                room: document.getElementById('itemRoom').value,
                category: document.getElementById('itemCategory').value,
                serialNumber: document.getElementById('itemSerial').value,
                currentValue: document.getElementById('itemCurrentValue').value,
                notes: document.getElementById('itemNotes').value,
                createdAt: currentEditingItem !== null ? homeItems[currentEditingItem].createdAt : new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };

            if (currentEditingItem !== null) {
                homeItems[currentEditingItem] = item;
                showNotification('Item updated successfully', 'success');
            } else {
                homeItems.push(item);
                showNotification('Item added successfully', 'success');
            }

            saveHomeItems();
            renderAllContent();
            closeModal();
        }

        function toggleTheme() {
            currentTheme = currentTheme === 'light' ? 'dark' : 'light';
            applyTheme();
            localStorage.setItem('theme', currentTheme);
        }

        function applyTheme() {
            document.documentElement.setAttribute('data-theme', currentTheme);
            document.getElementById('theme-icon').textContent = currentTheme === 'light' ? 'üåô' : '‚òÄÔ∏è';
        }

        function getRoomText(room) {
            const rooms = {
                'living-room': 'Living Room',
                'dining-room': 'Dining Room',
                'bedroom': 'Bedroom',
                'kitchen': 'Kitchen',
                'bathroom': 'Bathroom',
                'office': 'Office',
                'garage': 'Garage',
                'basement': 'Basement',
                'attic': 'Attic',
                'closet': 'Closet',
                'other': 'Other'
            };
            return rooms[room] || 'Other';
        }

        function getCategoryText(category) {
            const categories = {
                'electronics': 'Electronics',
                'furniture': 'Furniture',
                'appliances': 'Appliances',
                'jewelry': 'Jewelry',
                'art': 'Art & Collectibles',
                'clothing': 'Clothing',
                'books': 'Books',
                'tools': 'Tools',
                'sports': 'Sports Equipment',
                'musical': 'Musical Instruments',
                'other': 'Other'
            };
            return categories[category] || 'Other';
        }

        function getCategoryIcon(category) {
            const icons = {
                'electronics': 'üì±',
                'furniture': 'ü™ë',
                'appliances': 'üè†',
                'jewelry': 'üíé',
                'art': 'üé®',
                'clothing': 'üëï',
                'books': 'üìö',
                'tools': 'üîß',
                'sports': '‚öΩ',
                'musical': 'üéπ',
                'other': 'üì¶'
            };
            return icons[category] || 'üì¶';
        }

        function exportData() {
            const dataStr = JSON.stringify(homeItems, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `inventoria-data-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            URL.revokeObjectURL(url);
            showNotification('Data exported successfully', 'success');
        }

        function importData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        try {
                            const importedItems = JSON.parse(e.target.result);
                            if (Array.isArray(importedItems)) {
                                homeItems = importedItems;
                                saveHomeItems();
                                renderAllContent();
                                showNotification('Data imported successfully', 'success');
                            } else {
                                showNotification('Invalid file format', 'error');
                            }
                        } catch (error) {
                            showNotification('Error importing file', 'error');
                        }
                    };
                    reader.readAsText(file);
                }
            };
            input.click();
        }

        function generateReport() {
            const totalValue = homeItems.reduce((sum, item) => sum + (parseFloat(item.currentValue) || 0), 0);
            const roomBreakdown = {};
            const categoryBreakdown = {};

            homeItems.forEach(item => {
                const room = getRoomText(item.room);
                const category = getCategoryText(item.category);
                const value = parseFloat(item.currentValue) || 0;

                roomBreakdown[room] = (roomBreakdown[room] || 0) + value;
                categoryBreakdown[category] = (categoryBreakdown[category] || 0) + value;
            });

            let reportHTML = `
                <html>
                <head>
                    <title>InventorIA AI Professional Report - Ayesha Khalique</title>
                    <style>
                        body { 
                            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif; 
                            margin: 0; 
                            background: #ffffff;
                            color: #1e293b;
                        }
                        .container {
                            background: #ffffff;
                            border-radius: 16px;
                            padding: 0;
                            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1);
                            border: 1px solid #e2e8f0;
                        }
                        .header { text-align: center; margin-bottom: 40px; }
                        .logo { 
                            display: flex; 
                            align-items: center; 
                            justify-content: center; 
                            gap: 1rem; 
                            margin-bottom: 20px; 
                        }
                        .logo-text { font-size: 2.5rem; font-weight: 700; color: #4f46e5; }
                        .logo-ai { color: #00d4ff; text-shadow: 0 0 10px #00d4ff; }
                        .summary { 
                            background: #f8fafc; 
                            padding: 0; 
                            border-radius: 12px; 
                            margin-bottom: 30px; 
                            border: 1px solid #e2e8f0;
                        }
                        .owner-info {
                            display: grid;
                            grid-template-columns: 1fr 1fr;
                            gap: 20px;
                            margin-bottom: 30px;
                            background: #f1f5f9;
                            padding: 0;
                            border-radius: 12px;
                            border: 1px solid #cbd5e1;
                        }
                        .breakdown { margin-bottom: 30px; }
                        table { 
                            width: 100%; 
                            border-collapse: collapse; 
                            margin-bottom: 20px; 
                            background: #ffffff;
                            border-radius: 8px;
                            overflow: hidden;
                            box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1);
                        }
                        th, td { padding: 0; text-align: left; border-bottom: 1px solid #e2e8f0; }
                        th { 
                            background: #f8fafc; 
                            font-weight: 700; 
                            color: #4f46e5;
                        }
                        h1 { color: #4f46e5; font-size: 2.5rem; margin-bottom: 10px; }
                        h2 { color: #7c3aed; font-size: 1.6rem; margin-bottom: 20px; }
                        .escloud { 
                            color: #64748b; 
                            font-size: 1.1rem; 
                            margin-bottom: 30px; 
                        }
                        .total-value { 
                            font-size: 2rem; 
                            font-weight: 800; 
                            color: #4f46e5; 
                            text-align: center; 
                            margin: 0; 
                        }
                        .footer {
                            text-align: center;
                            margin-top: 40px;
                            padding-top: 20px;
                            border-top: 1px solid #e2e8f0;
                            color: #64748b;
                        }
                    </style>
                </head>
                <body>
                    <div class="container">
                        <div class="header">
                            <div class="logo">
                                <div>
                                    <div class="logo-text">Inventor<span class="logo-ai">IA</span> AI</div>
                                    <div class="escloud">Professional Home Inventory Report</div>
                                </div>
                            </div>
                        </div>

                        <div class="owner-info">
                            <div>
                                <h3>Owner Information</h3>
                                <p><strong>Name:</strong> Ayesha Khalique</p>
                                <p><strong>Address:</strong> 4567 8th Ave, Carson City</p>
                                <p><strong>Phone:</strong> (916) 555-0123</p>
                            </div>
                            <div>
                                <h3>Insurance Details</h3>
                                <p><strong>Policy:</strong> XYZ789</p>
                                <p><strong>Agent:</strong> Petja Hrovat</p>
                                <p><strong>Agent Phone:</strong> (123) 456-7890</p>
                            </div>
                        </div>

                        <div class="summary">
                            <h2>Inventory Summary</h2>
                            <div class="total-value">Total Value: $${totalValue.toLocaleString()}</div>
                            <p><strong>Total Items:</strong> ${homeItems.length}</p>
                            <p><strong>Report Generated:</strong> ${new Date().toLocaleDateString()}</p>
                        </div>

                        <div class="breakdown">
                            <h2>Value by Category</h2>
                            <table>
                                <tr><th>Category</th><th>Value</th></tr>
                                ${Object.entries(categoryBreakdown).map(([cat, val]) => 
                                    `<tr><td>${cat}</td><td>$${val.toLocaleString()}</td></tr>`
                                ).join('')}
                            </table>
                        </div>

                        <div class="breakdown">
                            <h2>Value by Room</h2>
                            <table>
                                <tr><th>Room</th><th>Value</th></tr>
                                ${Object.entries(roomBreakdown).map(([room, val]) => 
                                    `<tr><td>${room}</td><td>$${val.toLocaleString()}</td></tr>`
                                ).join('')}
                            </table>
                        </div>

                        <div class="breakdown">
                            <h2>Complete Item List</h2>
                            <table>
                                <tr><th>Item</th><th>Category</th><th>Room</th><th>Value</th><th>Serial</th><th>Notes</th></tr>
                                ${homeItems.map(item => `
                                    <tr>
                                        <td><strong>${item.name}</strong><br><small>${item.description || ''}</small></td>
                                        <td>${getCategoryText(item.category)}</td>
                                        <td>${getRoomText(item.room)}</td>
                                        <td>$${parseFloat(item.currentValue || 0).toLocaleString()}</td>
                                        <td>${item.serialNumber || '-'}</td>
                                        <td>${item.notes || '-'}</td>
                                    </tr>
                                `).join('')}
                            </table>
                        </div>

                        <div class="footer">
                            <p><strong>InventorIA AI by Escloud</strong></p>
                            <p>Professional Home Inventory Management System</p>
                            <p>Generated on ${new Date().toLocaleString()}</p>
                        </div>
                    </div>
                </body>
                </html>
            `;

            const reportBlob = new Blob([reportHTML], {type: 'text/html'});
            const url = URL.createObjectURL(reportBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `inventoria-report-${new Date().toISOString().split('T')[0]}.html`;
            link.click();
            URL.revokeObjectURL(url);
            showNotification('Report generated successfully', 'success');
        }

        function clearAllData() {
            if (confirm('Are you sure you want to clear all data? This cannot be undone.')) {
                homeItems = [];
                saveHomeItems();
                renderAllContent();
                showNotification('All data cleared', 'success');
            }
        }

        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => notification.classList.add('show'), 100);
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => document.body.removeChild(notification), 300);
            }, 3000);
        }
    </script>
</body>
</html>
